<!DOCTYPE html>
<html>
  <head>
    <title>On-Call Schedules</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
      }
      h1 {
        font-size: 24px;
      }
      .box {
        border: 1px solid #000;
        padding: 10px;
        margin: 20px;
        width: 300px;
        display: inline-block;
        text-align: left;
      }
    </style>
    <script>
      const apiKey = "AIzaSyAAv9OhKvEt5A6dpzr3gSfAEDiu8_IL8PQ";
      const spreadsheetId = "1-s7A-sGm19mClB1ryzEYbAWIm9hptVoPqjKZTs9ho7A";

      function fetchSchedule(sheetName) {
        const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${sheetName}?key=${apiKey}`;
        return fetch(url)
          .then((response) => response.json())
          .then((data) => data.values);
      }

      function findCurrentOnCall(data) {
        const now = new Date();
        const todayDate = `${String(now.getDate()).padStart(2, '0')}/${String(now.getMonth() + 1).padStart(2, '0')}/${now.getFullYear()}`;
        const currentTime = now.getHours();
        for (let i = 1; i < data.length; i++) {
          const row = data[i];
          const [date, day, name, time, contact] = row;
          const dutyTimes = time.split(' - ');
          const startTime = parseInt(dutyTimes[0].split(':')[0]);
          const endTime = parseInt(dutyTimes[1].split(':')[0]);

          if (date === todayDate && (currentTime >= startTime || currentTime < endTime)) {
            return { name, contact, time };
          }
        }
        return null;
      }

      function displaySchedule(type, data) {
        const scheduleBox = document.getElementById(`${type}-schedule`);
        if (data) {
          scheduleBox.innerHTML = `<strong>Doctor:</strong> ${data.name}<br>
                                   <strong>Contact:</strong> ${data.contact}<br>
                                   <strong>Duty Time:</strong> ${data.time}`;
        } else {
          scheduleBox.innerHTML = `No ${type} is currently on-call.`;
        }
      }

      function loadSchedules() {
        fetchSchedule("Sheet1").then((consultantData) => {
          const consultantOnCall = findCurrentOnCall(consultantData);
          displaySchedule("consultant", consultantOnCall);
        });

        fetchSchedule("Sheet2").then((specialistData) => {
          const specialistOnCall = findCurrentOnCall(specialistData);
          displaySchedule("specialist", specialistOnCall);
        });
      }

      window.onload = loadSchedules;
    </script>
  </head>
  <body>
    <h1>On-Call Schedules</h1>
    <div class="box" id="consultant-schedule">
      <h2>Consultant On-Call</h2>
      Loading...
    </div>
    <div class="box" id="specialist-schedule">
      <h2>Specialist On-Call</h2>
      Loading...
    </div>
  </body>
</html>